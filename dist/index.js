import{deepmerge as o}from"deepmerge-ts";import{resolve as m}from"path";import{Rome as n,Distribution as p}from"@rometools/js-api";import{pipeline as a}from"@nikolarhristov/pipeline";import s from"./lib/get-config.js";import i from"./options/index.js";var c=(e={})=>{for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&e[r]===!0&&(e[r]=i[r]);return e=o(i,e),{name:"astro-rome",hooks:{"astro:build:done":async()=>{const r=await n.create({distribution:p.NODE});(typeof e.rome>"u"||e.rome===null)&&(e.rome=JSON.parse(await s("rome.json"))),e.rome&&e.rome!==!0&&r.applyConfiguration(e.rome),await new a(o(e,{pipeline:{wrote:async t=>r.formatContent(t.buffer.toString(),{filePath:m(t.inputPath)}).content}})).process()}}}};export{c as default};
